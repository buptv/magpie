# magpie
## 描述
随着业务的发展, 用户、资源和其他共享数据业务库散落在不同的库表, 甚至是不同的服务器和机房,为了做一些统计分析工作,
需要将这些数据汇集到搜索引擎或者hdfs等, 因此需要对散落在各处的元数据进行抽取和监听。
其中包括存量数据(历史数据)和增量数据(变更数据)。

## 处理流程
1. 存量数据多线程从MySQL或者MongoDB中读取, 以Task格式然后塞入队列中, 默认使用activeMQ;
2. 增量数据通过监听数据变化的方式,将变更信息以Task格式塞入队列; 其中MySQL监听binlog的变更, MongoDB通过读取oplog的形式获取变更信息;
3. 消费端通过轮询读取队列或者监听队列(默认)的方式获取Task格式的任务, 然后经过一系列filters的处理, 将数据放入存储引擎或者其他存储单元;

## 特点
1. 扩展性。各生产者和消费者只需要完成插件, 放到生产者容器或者消费者容器内即可。
2. 灵活性。可以灵活的完成各个插件的加载和卸载; 消费者可以顺序进行一些列的处理。
3. 一致性。使用hash算法将同一业务id的Task塞入同一队列, 增量数据单线程生产。
4. 高吞吐。考虑生产者生产速度可能远远大于消费者消费速度, 因此消费者端多线程监听并处理任务。
5. 高可用。使用zookeeper作为服务注册中心以及插件注册中心。
